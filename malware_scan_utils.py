import joblib
import pandas as pd
from extract import extract_pdf_features

# Load the model once
model = joblib.load("svm_model.pkl")
scaler = joblib.load("scaler.pkl")

def scan_pdf_file(path: str) -> bool:
    features_df = extract_pdf_features(path)
    new_pdf_scaled = scaler.transform(features_df)
    if new_pdf_scaled is None:
        return True  # If we can't extract features, better to play safe and block it

    prediction = model.predict(new_pdf_scaled)[0]
    return prediction == 0  # Return True if malware
